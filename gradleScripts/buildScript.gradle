task validateVariables {
    doFirst {
        File propsFile
        def jenkinsProps = "/home/jenkins/.gradle/gradle.properties"
        def localProps = "$projectDir/local.properties"
        def gradleProps = "$projectDir/gradle.properties"
        if (new File(jenkinsProps).exists()) {
            println "Found properties file: " + jenkinsProps
            propsFile = new File(jenkinsProps)
        } else if (new File(localProps).exists()) {
            println "Found properties file: " + localProps
            propsFile = new File(localProps)
        } else {
            println "Found properties file: " + gradleProps
            propsFile = new File(gradleProps)
        }
        def props = new Properties()
        propsFile.withInputStream { props.load(it) }

        def message = "Environment variable %s has not been set or is empty"
        assert props.getProperty("new_artifactory_cvsdk_path") : String.format(message, "new_artifactory_cvsdk_path")
        assert props.getProperty("new_artifactory_write_username") : String.format(message, "new_artifactory_write_username")
        assert props.getProperty("new_artifactory_write_password") : String.format(message, "new_artifactory_write_password")
        assert props.getProperty("oneapp_maven_username") : String.format(message, "oneapp_maven_username")
        assert props.getProperty("oneapp_maven_password") : String.format(message, "oneapp_maven_password")

        println("All Android environment variables set")
    }
}
